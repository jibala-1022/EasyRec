2024-11-03 01:13:07,939 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2024, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'movies', 'user_num': 16994, 'item_num': 9370}, 'model': {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1, 'steam': {'easyrec-roberta-large': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}}
2024-11-03 01:13:08,646 - Hyper Parameters: {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1, 'steam': {'easyrec-roberta-large': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}
2024-11-03 01:13:12,248 - Epoch   0 Validation set [recall@5: 0.0395 recall@10: 0.0585 recall@20: 0.0831 ] [ndcg@5: 0.0301 ndcg@10: 0.0367 ndcg@20: 0.0436 ] 
2024-11-03 01:13:20,101 - Epoch   3 Validation set [recall@5: 0.0284 recall@10: 0.0426 recall@20: 0.0663 ] [ndcg@5: 0.0221 ndcg@10: 0.0271 ndcg@20: 0.0336 ] 
2024-11-03 01:13:27,295 - Epoch   6 Validation set [recall@5: 0.0300 recall@10: 0.0480 recall@20: 0.0773 ] [ndcg@5: 0.0236 ndcg@10: 0.0299 ndcg@20: 0.0380 ] 
2024-11-03 01:13:33,930 - Epoch   9 Validation set [recall@5: 0.0339 recall@10: 0.0550 recall@20: 0.0896 ] [ndcg@5: 0.0266 ndcg@10: 0.0339 ndcg@20: 0.0436 ] 
2024-11-03 01:13:40,488 - Epoch  12 Validation set [recall@5: 0.0376 recall@10: 0.0598 recall@20: 0.0949 ] [ndcg@5: 0.0295 ndcg@10: 0.0373 ndcg@20: 0.0471 ] 
2024-11-03 01:13:46,958 - Epoch  15 Validation set [recall@5: 0.0401 recall@10: 0.0642 recall@20: 0.0999 ] [ndcg@5: 0.0309 ndcg@10: 0.0395 ndcg@20: 0.0494 ] 
2024-11-03 01:13:53,583 - Epoch  18 Validation set [recall@5: 0.0417 recall@10: 0.0679 recall@20: 0.1056 ] [ndcg@5: 0.0324 ndcg@10: 0.0416 ndcg@20: 0.0521 ] 
2024-11-03 01:14:00,177 - Epoch  21 Validation set [recall@5: 0.0450 recall@10: 0.0716 recall@20: 0.1100 ] [ndcg@5: 0.0345 ndcg@10: 0.0438 ndcg@20: 0.0544 ] 
2024-11-03 01:14:07,114 - Epoch  24 Validation set [recall@5: 0.0482 recall@10: 0.0737 recall@20: 0.1147 ] [ndcg@5: 0.0366 ndcg@10: 0.0456 ndcg@20: 0.0569 ] 
2024-11-03 01:14:13,711 - Epoch  27 Validation set [recall@5: 0.0496 recall@10: 0.0774 recall@20: 0.1182 ] [ndcg@5: 0.0379 ndcg@10: 0.0476 ndcg@20: 0.0589 ] 
2024-11-03 01:14:20,272 - Epoch  30 Validation set [recall@5: 0.0512 recall@10: 0.0803 recall@20: 0.1212 ] [ndcg@5: 0.0393 ndcg@10: 0.0494 ndcg@20: 0.0608 ] 
2024-11-03 01:14:26,854 - Epoch  33 Validation set [recall@5: 0.0529 recall@10: 0.0832 recall@20: 0.1246 ] [ndcg@5: 0.0408 ndcg@10: 0.0514 ndcg@20: 0.0629 ] 
2024-11-03 01:14:33,341 - Epoch  36 Validation set [recall@5: 0.0537 recall@10: 0.0856 recall@20: 0.1269 ] [ndcg@5: 0.0417 ndcg@10: 0.0529 ndcg@20: 0.0644 ] 
2024-11-03 01:14:39,979 - Epoch  39 Validation set [recall@5: 0.0560 recall@10: 0.0869 recall@20: 0.1299 ] [ndcg@5: 0.0433 ndcg@10: 0.0541 ndcg@20: 0.0660 ] 
2024-11-03 01:14:46,653 - Epoch  42 Validation set [recall@5: 0.0580 recall@10: 0.0896 recall@20: 0.1326 ] [ndcg@5: 0.0448 ndcg@10: 0.0559 ndcg@20: 0.0678 ] 
2024-11-03 01:14:53,150 - Epoch  45 Validation set [recall@5: 0.0590 recall@10: 0.0923 recall@20: 0.1339 ] [ndcg@5: 0.0457 ndcg@10: 0.0574 ndcg@20: 0.0690 ] 
2024-11-03 01:14:59,754 - Epoch  48 Validation set [recall@5: 0.0608 recall@10: 0.0938 recall@20: 0.1364 ] [ndcg@5: 0.0471 ndcg@10: 0.0585 ndcg@20: 0.0704 ] 
2024-11-03 01:15:06,349 - Epoch  51 Validation set [recall@5: 0.0625 recall@10: 0.0949 recall@20: 0.1381 ] [ndcg@5: 0.0485 ndcg@10: 0.0597 ndcg@20: 0.0719 ] 
2024-11-03 01:15:12,888 - Epoch  54 Validation set [recall@5: 0.0636 recall@10: 0.0970 recall@20: 0.1400 ] [ndcg@5: 0.0492 ndcg@10: 0.0608 ndcg@20: 0.0728 ] 
2024-11-03 01:15:19,443 - Epoch  57 Validation set [recall@5: 0.0655 recall@10: 0.0975 recall@20: 0.1431 ] [ndcg@5: 0.0503 ndcg@10: 0.0615 ndcg@20: 0.0742 ] 
2024-11-03 01:15:26,020 - Epoch  60 Validation set [recall@5: 0.0663 recall@10: 0.0998 recall@20: 0.1449 ] [ndcg@5: 0.0510 ndcg@10: 0.0627 ndcg@20: 0.0752 ] 
2024-11-03 01:15:32,797 - Epoch  63 Validation set [recall@5: 0.0680 recall@10: 0.1002 recall@20: 0.1455 ] [ndcg@5: 0.0523 ndcg@10: 0.0635 ndcg@20: 0.0762 ] 
2024-11-03 01:15:39,506 - Epoch  66 Validation set [recall@5: 0.0686 recall@10: 0.1019 recall@20: 0.1468 ] [ndcg@5: 0.0526 ndcg@10: 0.0642 ndcg@20: 0.0769 ] 
2024-11-03 01:15:46,037 - Epoch  69 Validation set [recall@5: 0.0700 recall@10: 0.1030 recall@20: 0.1487 ] [ndcg@5: 0.0537 ndcg@10: 0.0652 ndcg@20: 0.0781 ] 
2024-11-03 01:15:52,756 - Epoch  72 Validation set [recall@5: 0.0695 recall@10: 0.1037 recall@20: 0.1488 ] [ndcg@5: 0.0537 ndcg@10: 0.0657 ndcg@20: 0.0784 ] 
2024-11-03 01:15:59,410 - Epoch  75 Validation set [recall@5: 0.0699 recall@10: 0.1061 recall@20: 0.1506 ] [ndcg@5: 0.0540 ndcg@10: 0.0667 ndcg@20: 0.0792 ] 
2024-11-03 01:16:06,037 - Epoch  78 Validation set [recall@5: 0.0718 recall@10: 0.1064 recall@20: 0.1524 ] [ndcg@5: 0.0552 ndcg@10: 0.0673 ndcg@20: 0.0802 ] 
2024-11-03 01:16:12,774 - Epoch  81 Validation set [recall@5: 0.0721 recall@10: 0.1063 recall@20: 0.1529 ] [ndcg@5: 0.0558 ndcg@10: 0.0678 ndcg@20: 0.0810 ] 
2024-11-03 01:16:20,884 - Epoch  84 Validation set [recall@5: 0.0732 recall@10: 0.1072 recall@20: 0.1531 ] [ndcg@5: 0.0564 ndcg@10: 0.0684 ndcg@20: 0.0814 ] 
2024-11-03 01:16:29,517 - Epoch  87 Validation set [recall@5: 0.0733 recall@10: 0.1083 recall@20: 0.1530 ] [ndcg@5: 0.0567 ndcg@10: 0.0690 ndcg@20: 0.0817 ] 
2024-11-03 01:16:37,027 - Epoch  90 Validation set [recall@5: 0.0741 recall@10: 0.1082 recall@20: 0.1540 ] [ndcg@5: 0.0572 ndcg@10: 0.0692 ndcg@20: 0.0822 ] 
2024-11-03 01:16:44,062 - Epoch  93 Validation set [recall@5: 0.0742 recall@10: 0.1094 recall@20: 0.1549 ] [ndcg@5: 0.0573 ndcg@10: 0.0696 ndcg@20: 0.0825 ] 
2024-11-03 01:16:50,772 - Epoch  96 Validation set [recall@5: 0.0746 recall@10: 0.1092 recall@20: 0.1559 ] [ndcg@5: 0.0580 ndcg@10: 0.0701 ndcg@20: 0.0833 ] 
2024-11-03 01:16:57,759 - Epoch  99 Validation set [recall@5: 0.0753 recall@10: 0.1116 recall@20: 0.1569 ] [ndcg@5: 0.0584 ndcg@10: 0.0712 ndcg@20: 0.0839 ] 
2024-11-03 01:17:04,387 - Epoch 102 Validation set [recall@5: 0.0769 recall@10: 0.1111 recall@20: 0.1575 ] [ndcg@5: 0.0597 ndcg@10: 0.0719 ndcg@20: 0.0849 ] 
2024-11-03 01:17:11,063 - Epoch 105 Validation set [recall@5: 0.0771 recall@10: 0.1120 recall@20: 0.1579 ] [ndcg@5: 0.0597 ndcg@10: 0.0720 ndcg@20: 0.0849 ] 
2024-11-03 01:17:17,964 - Epoch 108 Validation set [recall@5: 0.0776 recall@10: 0.1118 recall@20: 0.1582 ] [ndcg@5: 0.0600 ndcg@10: 0.0720 ndcg@20: 0.0851 ] 
2024-11-03 01:17:24,550 - Epoch 111 Validation set [recall@5: 0.0784 recall@10: 0.1127 recall@20: 0.1584 ] [ndcg@5: 0.0600 ndcg@10: 0.0721 ndcg@20: 0.0850 ] 
2024-11-03 01:17:31,073 - Epoch 114 Validation set [recall@5: 0.0784 recall@10: 0.1128 recall@20: 0.1587 ] [ndcg@5: 0.0607 ndcg@10: 0.0727 ndcg@20: 0.0857 ] 
2024-11-03 01:17:37,626 - Epoch 117 Validation set [recall@5: 0.0789 recall@10: 0.1138 recall@20: 0.1591 ] [ndcg@5: 0.0608 ndcg@10: 0.0730 ndcg@20: 0.0858 ] 
2024-11-03 01:17:44,170 - Epoch 120 Validation set [recall@5: 0.0783 recall@10: 0.1133 recall@20: 0.1610 ] [ndcg@5: 0.0608 ndcg@10: 0.0732 ndcg@20: 0.0866 ] 
2024-11-03 01:17:50,715 - Epoch 123 Validation set [recall@5: 0.0789 recall@10: 0.1137 recall@20: 0.1608 ] [ndcg@5: 0.0614 ndcg@10: 0.0736 ndcg@20: 0.0869 ] 
2024-11-03 01:17:57,383 - Epoch 126 Validation set [recall@5: 0.0788 recall@10: 0.1134 recall@20: 0.1617 ] [ndcg@5: 0.0608 ndcg@10: 0.0730 ndcg@20: 0.0866 ] 
2024-11-03 01:18:04,014 - Epoch 129 Validation set [recall@5: 0.0792 recall@10: 0.1132 recall@20: 0.1627 ] [ndcg@5: 0.0611 ndcg@10: 0.0730 ndcg@20: 0.0868 ] 
2024-11-03 01:18:10,723 - Epoch 132 Validation set [recall@5: 0.0797 recall@10: 0.1127 recall@20: 0.1628 ] [ndcg@5: 0.0612 ndcg@10: 0.0728 ndcg@20: 0.0869 ] 
2024-11-03 01:18:17,562 - Epoch 135 Validation set [recall@5: 0.0793 recall@10: 0.1137 recall@20: 0.1629 ] [ndcg@5: 0.0613 ndcg@10: 0.0734 ndcg@20: 0.0873 ] 
2024-11-03 01:18:24,293 - Epoch 138 Validation set [recall@5: 0.0796 recall@10: 0.1141 recall@20: 0.1629 ] [ndcg@5: 0.0614 ndcg@10: 0.0736 ndcg@20: 0.0873 ] 
2024-11-03 01:18:31,031 - Epoch 141 Validation set [recall@5: 0.0795 recall@10: 0.1146 recall@20: 0.1635 ] [ndcg@5: 0.0614 ndcg@10: 0.0739 ndcg@20: 0.0877 ] 
2024-11-03 01:18:37,955 - Epoch 144 Validation set [recall@5: 0.0802 recall@10: 0.1161 recall@20: 0.1627 ] [ndcg@5: 0.0619 ndcg@10: 0.0747 ndcg@20: 0.0877 ] 
2024-11-03 01:18:44,888 - Epoch 147 Validation set [recall@5: 0.0806 recall@10: 0.1160 recall@20: 0.1643 ] [ndcg@5: 0.0627 ndcg@10: 0.0752 ndcg@20: 0.0888 ] 
2024-11-03 01:18:51,481 - Epoch 150 Validation set [recall@5: 0.0815 recall@10: 0.1171 recall@20: 0.1635 ] [ndcg@5: 0.0630 ndcg@10: 0.0755 ndcg@20: 0.0886 ] 
2024-11-03 01:18:58,059 - Epoch 153 Validation set [recall@5: 0.0813 recall@10: 0.1163 recall@20: 0.1631 ] [ndcg@5: 0.0627 ndcg@10: 0.0751 ndcg@20: 0.0883 ] 
2024-11-03 01:19:04,674 - Epoch 156 Validation set [recall@5: 0.0818 recall@10: 0.1174 recall@20: 0.1640 ] [ndcg@5: 0.0632 ndcg@10: 0.0758 ndcg@20: 0.0888 ] 
2024-11-03 01:19:11,259 - Epoch 159 Validation set [recall@5: 0.0817 recall@10: 0.1169 recall@20: 0.1638 ] [ndcg@5: 0.0633 ndcg@10: 0.0757 ndcg@20: 0.0889 ] 
2024-11-03 01:19:17,857 - Epoch 162 Validation set [recall@5: 0.0820 recall@10: 0.1163 recall@20: 0.1635 ] [ndcg@5: 0.0638 ndcg@10: 0.0759 ndcg@20: 0.0892 ] 
2024-11-03 01:19:18,840 - [recall@5: 0.0806 recall@10: 0.1160 recall@20: 0.1643 ] [ndcg@5: 0.0627 ndcg@10: 0.0752 ndcg@20: 0.0888 ] 
2024-11-03 01:19:19,931 - [recall@5: 0.0838 recall@10: 0.1174 recall@20: 0.1653 ] [ndcg@5: 0.0658 ndcg@10: 0.0774 ndcg@20: 0.0907 ] 
2024-11-03 01:19:19,931 - Best Epoch 147. Final test result: {'recall': array([0.08383796, 0.11740719, 0.16530161]), 'ndcg': array([0.06575944, 0.07737274, 0.09068687])}.
