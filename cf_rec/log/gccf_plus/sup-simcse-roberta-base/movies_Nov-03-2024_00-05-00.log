2024-11-03 00:05:00,716 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2024, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'movies', 'user_num': 16994, 'item_num': 9370}, 'model': {'name': 'gccf_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.01, 'kd_temperature': 0.5, 'steam': {'easyrec-roberta-large': {'layer_num': 3, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}}
2024-11-03 00:05:01,245 - Hyper Parameters: {'name': 'gccf_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.01, 'kd_temperature': 0.5, 'steam': {'easyrec-roberta-large': {'layer_num': 3, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}
2024-11-03 00:05:04,607 - Epoch   0 Validation set [recall@5: 0.0168 recall@10: 0.0265 recall@20: 0.0404 ] [ndcg@5: 0.0123 ndcg@10: 0.0157 ndcg@20: 0.0196 ] 
2024-11-03 00:05:11,363 - Epoch   3 Validation set [recall@5: 0.0355 recall@10: 0.0519 recall@20: 0.0785 ] [ndcg@5: 0.0275 ndcg@10: 0.0333 ndcg@20: 0.0407 ] 
2024-11-03 00:05:17,983 - Epoch   6 Validation set [recall@5: 0.0448 recall@10: 0.0645 recall@20: 0.0920 ] [ndcg@5: 0.0344 ndcg@10: 0.0413 ndcg@20: 0.0489 ] 
2024-11-03 00:05:24,656 - Epoch   9 Validation set [recall@5: 0.0465 recall@10: 0.0679 recall@20: 0.0979 ] [ndcg@5: 0.0355 ndcg@10: 0.0429 ndcg@20: 0.0514 ] 
2024-11-03 00:05:31,442 - Epoch  12 Validation set [recall@5: 0.0468 recall@10: 0.0695 recall@20: 0.1020 ] [ndcg@5: 0.0358 ndcg@10: 0.0437 ndcg@20: 0.0528 ] 
2024-11-03 00:05:38,053 - Epoch  15 Validation set [recall@5: 0.0467 recall@10: 0.0703 recall@20: 0.1045 ] [ndcg@5: 0.0358 ndcg@10: 0.0441 ndcg@20: 0.0536 ] 
2024-11-03 00:05:44,714 - Epoch  18 Validation set [recall@5: 0.0470 recall@10: 0.0704 recall@20: 0.1069 ] [ndcg@5: 0.0358 ndcg@10: 0.0440 ndcg@20: 0.0542 ] 
2024-11-03 00:05:51,353 - Epoch  21 Validation set [recall@5: 0.0473 recall@10: 0.0715 recall@20: 0.1087 ] [ndcg@5: 0.0360 ndcg@10: 0.0445 ndcg@20: 0.0549 ] 
2024-11-03 00:05:58,045 - Epoch  24 Validation set [recall@5: 0.0477 recall@10: 0.0730 recall@20: 0.1115 ] [ndcg@5: 0.0364 ndcg@10: 0.0453 ndcg@20: 0.0560 ] 
2024-11-03 00:06:04,676 - Epoch  27 Validation set [recall@5: 0.0480 recall@10: 0.0742 recall@20: 0.1128 ] [ndcg@5: 0.0364 ndcg@10: 0.0455 ndcg@20: 0.0563 ] 
2024-11-03 00:06:11,344 - Epoch  30 Validation set [recall@5: 0.0488 recall@10: 0.0748 recall@20: 0.1141 ] [ndcg@5: 0.0367 ndcg@10: 0.0457 ndcg@20: 0.0568 ] 
2024-11-03 00:06:18,044 - Epoch  33 Validation set [recall@5: 0.0486 recall@10: 0.0762 recall@20: 0.1170 ] [ndcg@5: 0.0369 ndcg@10: 0.0465 ndcg@20: 0.0579 ] 
2024-11-03 00:06:24,681 - Epoch  36 Validation set [recall@5: 0.0496 recall@10: 0.0769 recall@20: 0.1179 ] [ndcg@5: 0.0373 ndcg@10: 0.0467 ndcg@20: 0.0582 ] 
2024-11-03 00:06:31,361 - Epoch  39 Validation set [recall@5: 0.0503 recall@10: 0.0784 recall@20: 0.1200 ] [ndcg@5: 0.0373 ndcg@10: 0.0470 ndcg@20: 0.0586 ] 
2024-11-03 00:06:38,118 - Epoch  42 Validation set [recall@5: 0.0511 recall@10: 0.0795 recall@20: 0.1215 ] [ndcg@5: 0.0379 ndcg@10: 0.0477 ndcg@20: 0.0594 ] 
2024-11-03 00:06:44,881 - Epoch  45 Validation set [recall@5: 0.0520 recall@10: 0.0800 recall@20: 0.1231 ] [ndcg@5: 0.0386 ndcg@10: 0.0484 ndcg@20: 0.0604 ] 
2024-11-03 00:06:51,709 - Epoch  48 Validation set [recall@5: 0.0518 recall@10: 0.0806 recall@20: 0.1233 ] [ndcg@5: 0.0386 ndcg@10: 0.0485 ndcg@20: 0.0605 ] 
2024-11-03 00:06:58,589 - Epoch  51 Validation set [recall@5: 0.0528 recall@10: 0.0818 recall@20: 0.1237 ] [ndcg@5: 0.0392 ndcg@10: 0.0492 ndcg@20: 0.0610 ] 
2024-11-03 00:07:05,358 - Epoch  54 Validation set [recall@5: 0.0531 recall@10: 0.0819 recall@20: 0.1253 ] [ndcg@5: 0.0396 ndcg@10: 0.0496 ndcg@20: 0.0619 ] 
2024-11-03 00:07:12,185 - Epoch  57 Validation set [recall@5: 0.0540 recall@10: 0.0839 recall@20: 0.1252 ] [ndcg@5: 0.0401 ndcg@10: 0.0505 ndcg@20: 0.0621 ] 
2024-11-03 00:07:18,899 - Epoch  60 Validation set [recall@5: 0.0539 recall@10: 0.0835 recall@20: 0.1260 ] [ndcg@5: 0.0401 ndcg@10: 0.0505 ndcg@20: 0.0625 ] 
2024-11-03 00:07:25,572 - Epoch  63 Validation set [recall@5: 0.0542 recall@10: 0.0840 recall@20: 0.1277 ] [ndcg@5: 0.0406 ndcg@10: 0.0510 ndcg@20: 0.0633 ] 
2024-11-03 00:07:32,392 - Epoch  66 Validation set [recall@5: 0.0544 recall@10: 0.0859 recall@20: 0.1280 ] [ndcg@5: 0.0409 ndcg@10: 0.0519 ndcg@20: 0.0637 ] 
2024-11-03 00:07:39,371 - Epoch  69 Validation set [recall@5: 0.0546 recall@10: 0.0860 recall@20: 0.1294 ] [ndcg@5: 0.0409 ndcg@10: 0.0518 ndcg@20: 0.0641 ] 
2024-11-03 00:07:46,184 - Epoch  72 Validation set [recall@5: 0.0549 recall@10: 0.0859 recall@20: 0.1308 ] [ndcg@5: 0.0412 ndcg@10: 0.0520 ndcg@20: 0.0647 ] 
2024-11-03 00:07:52,783 - Epoch  75 Validation set [recall@5: 0.0552 recall@10: 0.0870 recall@20: 0.1321 ] [ndcg@5: 0.0417 ndcg@10: 0.0528 ndcg@20: 0.0655 ] 
2024-11-03 00:07:59,524 - Epoch  78 Validation set [recall@5: 0.0550 recall@10: 0.0880 recall@20: 0.1318 ] [ndcg@5: 0.0420 ndcg@10: 0.0536 ndcg@20: 0.0659 ] 
2024-11-03 00:08:06,246 - Epoch  81 Validation set [recall@5: 0.0552 recall@10: 0.0891 recall@20: 0.1336 ] [ndcg@5: 0.0420 ndcg@10: 0.0538 ndcg@20: 0.0662 ] 
2024-11-03 00:08:12,934 - Epoch  84 Validation set [recall@5: 0.0564 recall@10: 0.0893 recall@20: 0.1338 ] [ndcg@5: 0.0428 ndcg@10: 0.0543 ndcg@20: 0.0668 ] 
2024-11-03 00:08:19,609 - Epoch  87 Validation set [recall@5: 0.0572 recall@10: 0.0891 recall@20: 0.1352 ] [ndcg@5: 0.0433 ndcg@10: 0.0544 ndcg@20: 0.0673 ] 
2024-11-03 00:08:26,225 - Epoch  90 Validation set [recall@5: 0.0566 recall@10: 0.0898 recall@20: 0.1358 ] [ndcg@5: 0.0430 ndcg@10: 0.0546 ndcg@20: 0.0675 ] 
2024-11-03 00:08:33,036 - Epoch  93 Validation set [recall@5: 0.0580 recall@10: 0.0907 recall@20: 0.1367 ] [ndcg@5: 0.0438 ndcg@10: 0.0551 ndcg@20: 0.0679 ] 
2024-11-03 00:08:39,672 - Epoch  96 Validation set [recall@5: 0.0585 recall@10: 0.0908 recall@20: 0.1372 ] [ndcg@5: 0.0442 ndcg@10: 0.0553 ndcg@20: 0.0684 ] 
2024-11-03 00:08:46,363 - Epoch  99 Validation set [recall@5: 0.0588 recall@10: 0.0915 recall@20: 0.1377 ] [ndcg@5: 0.0443 ndcg@10: 0.0557 ndcg@20: 0.0686 ] 
2024-11-03 00:08:53,158 - Epoch 102 Validation set [recall@5: 0.0598 recall@10: 0.0923 recall@20: 0.1386 ] [ndcg@5: 0.0451 ndcg@10: 0.0563 ndcg@20: 0.0693 ] 
2024-11-03 00:08:59,854 - Epoch 105 Validation set [recall@5: 0.0604 recall@10: 0.0921 recall@20: 0.1388 ] [ndcg@5: 0.0456 ndcg@10: 0.0566 ndcg@20: 0.0697 ] 
2024-11-03 00:09:06,563 - Epoch 108 Validation set [recall@5: 0.0608 recall@10: 0.0934 recall@20: 0.1404 ] [ndcg@5: 0.0456 ndcg@10: 0.0570 ndcg@20: 0.0701 ] 
2024-11-03 00:09:13,319 - Epoch 111 Validation set [recall@5: 0.0614 recall@10: 0.0937 recall@20: 0.1405 ] [ndcg@5: 0.0460 ndcg@10: 0.0573 ndcg@20: 0.0704 ] 
2024-11-03 00:09:19,929 - Epoch 114 Validation set [recall@5: 0.0612 recall@10: 0.0942 recall@20: 0.1408 ] [ndcg@5: 0.0459 ndcg@10: 0.0574 ndcg@20: 0.0704 ] 
2024-11-03 00:09:26,594 - Epoch 117 Validation set [recall@5: 0.0614 recall@10: 0.0950 recall@20: 0.1411 ] [ndcg@5: 0.0460 ndcg@10: 0.0577 ndcg@20: 0.0706 ] 
2024-11-03 00:09:33,327 - Epoch 120 Validation set [recall@5: 0.0617 recall@10: 0.0955 recall@20: 0.1425 ] [ndcg@5: 0.0465 ndcg@10: 0.0583 ndcg@20: 0.0715 ] 
2024-11-03 00:09:39,998 - Epoch 123 Validation set [recall@5: 0.0624 recall@10: 0.0966 recall@20: 0.1425 ] [ndcg@5: 0.0472 ndcg@10: 0.0591 ndcg@20: 0.0719 ] 
2024-11-03 00:09:46,606 - Epoch 126 Validation set [recall@5: 0.0619 recall@10: 0.0963 recall@20: 0.1439 ] [ndcg@5: 0.0467 ndcg@10: 0.0587 ndcg@20: 0.0720 ] 
2024-11-03 00:09:53,256 - Epoch 129 Validation set [recall@5: 0.0628 recall@10: 0.0968 recall@20: 0.1445 ] [ndcg@5: 0.0474 ndcg@10: 0.0592 ndcg@20: 0.0725 ] 
2024-11-03 00:10:00,197 - Epoch 132 Validation set [recall@5: 0.0625 recall@10: 0.0972 recall@20: 0.1446 ] [ndcg@5: 0.0470 ndcg@10: 0.0591 ndcg@20: 0.0723 ] 
2024-11-03 00:10:06,800 - Epoch 135 Validation set [recall@5: 0.0630 recall@10: 0.0977 recall@20: 0.1456 ] [ndcg@5: 0.0475 ndcg@10: 0.0596 ndcg@20: 0.0729 ] 
2024-11-03 00:10:13,526 - Epoch 138 Validation set [recall@5: 0.0632 recall@10: 0.0984 recall@20: 0.1454 ] [ndcg@5: 0.0477 ndcg@10: 0.0600 ndcg@20: 0.0732 ] 
2024-11-03 00:10:20,107 - Epoch 141 Validation set [recall@5: 0.0639 recall@10: 0.0991 recall@20: 0.1457 ] [ndcg@5: 0.0480 ndcg@10: 0.0603 ndcg@20: 0.0733 ] 
2024-11-03 00:10:26,772 - Epoch 144 Validation set [recall@5: 0.0641 recall@10: 0.0999 recall@20: 0.1458 ] [ndcg@5: 0.0482 ndcg@10: 0.0607 ndcg@20: 0.0736 ] 
2024-11-03 00:10:33,682 - Epoch 147 Validation set [recall@5: 0.0654 recall@10: 0.1012 recall@20: 0.1463 ] [ndcg@5: 0.0489 ndcg@10: 0.0613 ndcg@20: 0.0739 ] 
2024-11-03 00:10:40,318 - Epoch 150 Validation set [recall@5: 0.0662 recall@10: 0.1015 recall@20: 0.1462 ] [ndcg@5: 0.0496 ndcg@10: 0.0618 ndcg@20: 0.0743 ] 
2024-11-03 00:10:47,077 - Epoch 153 Validation set [recall@5: 0.0658 recall@10: 0.1007 recall@20: 0.1464 ] [ndcg@5: 0.0497 ndcg@10: 0.0619 ndcg@20: 0.0747 ] 
2024-11-03 00:10:53,754 - Epoch 156 Validation set [recall@5: 0.0658 recall@10: 0.1009 recall@20: 0.1473 ] [ndcg@5: 0.0496 ndcg@10: 0.0619 ndcg@20: 0.0749 ] 
2024-11-03 00:11:00,475 - Epoch 159 Validation set [recall@5: 0.0654 recall@10: 0.1011 recall@20: 0.1471 ] [ndcg@5: 0.0497 ndcg@10: 0.0622 ndcg@20: 0.0751 ] 
2024-11-03 00:11:07,147 - Epoch 162 Validation set [recall@5: 0.0662 recall@10: 0.1010 recall@20: 0.1483 ] [ndcg@5: 0.0501 ndcg@10: 0.0623 ndcg@20: 0.0756 ] 
2024-11-03 00:11:13,739 - Epoch 165 Validation set [recall@5: 0.0663 recall@10: 0.1011 recall@20: 0.1488 ] [ndcg@5: 0.0502 ndcg@10: 0.0624 ndcg@20: 0.0757 ] 
2024-11-03 00:11:20,417 - Epoch 168 Validation set [recall@5: 0.0663 recall@10: 0.1024 recall@20: 0.1482 ] [ndcg@5: 0.0501 ndcg@10: 0.0627 ndcg@20: 0.0756 ] 
2024-11-03 00:11:27,095 - Epoch 171 Validation set [recall@5: 0.0672 recall@10: 0.1020 recall@20: 0.1489 ] [ndcg@5: 0.0509 ndcg@10: 0.0631 ndcg@20: 0.0762 ] 
2024-11-03 00:11:33,939 - Epoch 174 Validation set [recall@5: 0.0673 recall@10: 0.1028 recall@20: 0.1491 ] [ndcg@5: 0.0509 ndcg@10: 0.0633 ndcg@20: 0.0763 ] 
2024-11-03 00:11:40,635 - Epoch 177 Validation set [recall@5: 0.0672 recall@10: 0.1035 recall@20: 0.1493 ] [ndcg@5: 0.0506 ndcg@10: 0.0633 ndcg@20: 0.0761 ] 
2024-11-03 00:11:47,225 - Epoch 180 Validation set [recall@5: 0.0678 recall@10: 0.1035 recall@20: 0.1502 ] [ndcg@5: 0.0508 ndcg@10: 0.0634 ndcg@20: 0.0764 ] 
2024-11-03 00:11:53,899 - Epoch 183 Validation set [recall@5: 0.0680 recall@10: 0.1037 recall@20: 0.1505 ] [ndcg@5: 0.0511 ndcg@10: 0.0635 ndcg@20: 0.0765 ] 
2024-11-03 00:12:00,735 - Epoch 186 Validation set [recall@5: 0.0690 recall@10: 0.1037 recall@20: 0.1514 ] [ndcg@5: 0.0517 ndcg@10: 0.0638 ndcg@20: 0.0771 ] 
2024-11-03 00:12:07,448 - Epoch 189 Validation set [recall@5: 0.0685 recall@10: 0.1045 recall@20: 0.1512 ] [ndcg@5: 0.0516 ndcg@10: 0.0642 ndcg@20: 0.0773 ] 
2024-11-03 00:12:14,123 - Epoch 192 Validation set [recall@5: 0.0685 recall@10: 0.1039 recall@20: 0.1516 ] [ndcg@5: 0.0518 ndcg@10: 0.0641 ndcg@20: 0.0775 ] 
2024-11-03 00:12:20,716 - Epoch 195 Validation set [recall@5: 0.0690 recall@10: 0.1047 recall@20: 0.1514 ] [ndcg@5: 0.0521 ndcg@10: 0.0646 ndcg@20: 0.0777 ] 
2024-11-03 00:12:27,365 - Epoch 198 Validation set [recall@5: 0.0692 recall@10: 0.1049 recall@20: 0.1525 ] [ndcg@5: 0.0521 ndcg@10: 0.0645 ndcg@20: 0.0778 ] 
2024-11-03 00:12:34,093 - Epoch 201 Validation set [recall@5: 0.0695 recall@10: 0.1041 recall@20: 0.1527 ] [ndcg@5: 0.0524 ndcg@10: 0.0645 ndcg@20: 0.0781 ] 
2024-11-03 00:12:40,695 - Epoch 204 Validation set [recall@5: 0.0692 recall@10: 0.1054 recall@20: 0.1525 ] [ndcg@5: 0.0523 ndcg@10: 0.0649 ndcg@20: 0.0780 ] 
2024-11-03 00:12:47,328 - Epoch 207 Validation set [recall@5: 0.0696 recall@10: 0.1054 recall@20: 0.1532 ] [ndcg@5: 0.0525 ndcg@10: 0.0650 ndcg@20: 0.0783 ] 
2024-11-03 00:12:53,961 - Epoch 210 Validation set [recall@5: 0.0695 recall@10: 0.1049 recall@20: 0.1536 ] [ndcg@5: 0.0528 ndcg@10: 0.0651 ndcg@20: 0.0787 ] 
2024-11-03 00:13:00,703 - Epoch 213 Validation set [recall@5: 0.0699 recall@10: 0.1051 recall@20: 0.1545 ] [ndcg@5: 0.0527 ndcg@10: 0.0649 ndcg@20: 0.0787 ] 
2024-11-03 00:13:07,311 - Epoch 216 Validation set [recall@5: 0.0683 recall@10: 0.1050 recall@20: 0.1542 ] [ndcg@5: 0.0524 ndcg@10: 0.0651 ndcg@20: 0.0788 ] 
2024-11-03 00:13:13,960 - Epoch 219 Validation set [recall@5: 0.0699 recall@10: 0.1056 recall@20: 0.1547 ] [ndcg@5: 0.0529 ndcg@10: 0.0653 ndcg@20: 0.0790 ] 
2024-11-03 00:13:20,619 - Epoch 222 Validation set [recall@5: 0.0701 recall@10: 0.1058 recall@20: 0.1552 ] [ndcg@5: 0.0531 ndcg@10: 0.0655 ndcg@20: 0.0792 ] 
2024-11-03 00:13:27,217 - Epoch 225 Validation set [recall@5: 0.0700 recall@10: 0.1056 recall@20: 0.1544 ] [ndcg@5: 0.0534 ndcg@10: 0.0658 ndcg@20: 0.0794 ] 
2024-11-03 00:13:33,915 - Epoch 228 Validation set [recall@5: 0.0701 recall@10: 0.1060 recall@20: 0.1542 ] [ndcg@5: 0.0535 ndcg@10: 0.0659 ndcg@20: 0.0793 ] 
2024-11-03 00:13:40,554 - Epoch 231 Validation set [recall@5: 0.0701 recall@10: 0.1065 recall@20: 0.1558 ] [ndcg@5: 0.0535 ndcg@10: 0.0662 ndcg@20: 0.0798 ] 
2024-11-03 00:13:47,212 - Epoch 234 Validation set [recall@5: 0.0699 recall@10: 0.1064 recall@20: 0.1562 ] [ndcg@5: 0.0532 ndcg@10: 0.0659 ndcg@20: 0.0797 ] 
2024-11-03 00:13:53,884 - Epoch 237 Validation set [recall@5: 0.0689 recall@10: 0.1060 recall@20: 0.1554 ] [ndcg@5: 0.0527 ndcg@10: 0.0656 ndcg@20: 0.0793 ] 
2024-11-03 00:14:00,576 - Epoch 240 Validation set [recall@5: 0.0691 recall@10: 0.1069 recall@20: 0.1550 ] [ndcg@5: 0.0531 ndcg@10: 0.0662 ndcg@20: 0.0795 ] 
2024-11-03 00:14:07,232 - Epoch 243 Validation set [recall@5: 0.0693 recall@10: 0.1070 recall@20: 0.1557 ] [ndcg@5: 0.0531 ndcg@10: 0.0661 ndcg@20: 0.0796 ] 
2024-11-03 00:14:13,921 - Epoch 246 Validation set [recall@5: 0.0689 recall@10: 0.1071 recall@20: 0.1554 ] [ndcg@5: 0.0531 ndcg@10: 0.0664 ndcg@20: 0.0798 ] 
2024-11-03 00:14:20,667 - Epoch 249 Validation set [recall@5: 0.0682 recall@10: 0.1074 recall@20: 0.1555 ] [ndcg@5: 0.0529 ndcg@10: 0.0665 ndcg@20: 0.0798 ] 
2024-11-03 00:14:21,612 - [recall@5: 0.0699 recall@10: 0.1064 recall@20: 0.1562 ] [ndcg@5: 0.0532 ndcg@10: 0.0659 ndcg@20: 0.0797 ] 
2024-11-03 00:14:22,604 - [recall@5: 0.0706 recall@10: 0.1075 recall@20: 0.1562 ] [ndcg@5: 0.0530 ndcg@10: 0.0660 ndcg@20: 0.0796 ] 
2024-11-03 00:14:22,605 - Best Epoch 234. Final test result: {'recall': array([0.07058767, 0.10749313, 0.156249  ]), 'ndcg': array([0.05304584, 0.06595491, 0.07956989])}.
